#!/bin/bash

# р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З RAGAS Dataset р╕Ир╕▓р╕Б MongoDB

echo "ЁЯЪА р╣Ар╕гр╕┤р╣Ир╕бр╕кр╕гр╣Йр╕▓р╕З RAGAS Dataset р╕Ир╕▓р╕Б MongoDB"
echo "=========================================="

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣М .env р╕бр╕╡р╕нр╕вр╕╣р╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И
if [ ! -f .env ]; then
    echo "тЪая╕П  р╣Др╕бр╣Ир╕Юр╕Ър╣Др╕Яр╕ер╣М .env"
    echo "р╕Бр╕гр╕╕р╕Ур╕▓р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М .env р╣Бр╕ер╕░р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ MONGO_URL р╣Бр╕ер╕░ OPENAI_API_KEY"
    exit 1
fi

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Python
if ! command -v python3 &> /dev/null; then
    echo "тЭМ р╣Др╕бр╣Ир╕Юр╕Ъ Python3"
    exit 1
fi

# р╕гр╕▒р╕Щр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М
echo "ЁЯФД р╕Бр╕│р╕ер╕▒р╕Зр╕гр╕▒р╕Щр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М..."
python3 generate_ragas_dataset_from_mongo.py

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
if [ $? -eq 0 ]; then
    echo ""
    echo "тЬЕ р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З dataset р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ!"
    echo "ЁЯУБ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣М dataset_from_mongo.json"
else
    echo ""
    echo "тЭМ р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З dataset р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з"
    exit 1
fi

