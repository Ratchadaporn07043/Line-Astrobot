# คู่มือการใช้งานระบบคำนวณ Ascendant (ราศีประจำลัคนา)

## ภาพรวม

ระบบคำนวณ Ascendant (ราศีประจำลัคนา) เป็นฟีเจอร์ใหม่ที่เพิ่มเข้ามาในแชทบอทโหราศาสตร์ เพื่อให้การทำนายดวงชะตามีความแม่นยำและละเอียดมากขึ้น โดยใช้ข้อมูลเวลาเกิดและสถานที่เกิดในการคำนวณ

## ความสำคัญของ Ascendant

**Ascendant (ราศีประจำลัคนา)** เป็นจุดสำคัญในดวงชะตาที่แสดงถึง:
- บุคลิกภาพภายนอกและวิธีการที่ผู้อื่นมองเห็น
- ลักษณะการแสดงออกต่อสังคม
- วิธีการที่เราปฏิบัติต่อโลกภายนอก
- รูปแบบการเริ่มต้นสิ่งใหม่ๆ

## ฟีเจอร์ที่เพิ่มเข้ามา

### 1. การคำนวณ Ascendant
- คำนวณจากเวลาเกิดและสถานที่เกิด
- ใช้สูตรดาราศาสตร์ที่แม่นยำ
- รองรับพิกัดสถานที่เกิดในประเทศไทย

### 2. การคำนวณบ้านทั้ง 12 บ้าน (House Cusps)
- บ้านที่ 1: บุคลิกภาพและการแสดงออก (Ascendant)
- บ้านที่ 4: บ้านและครอบครัว (IC)
- บ้านที่ 7: ความสัมพันธ์และการแต่งงาน (Descendant)
- บ้านที่ 10: อาชีพและสถานะ (MC)
- และบ้านอื่นๆ ทั้ง 12 บ้าน

### 3. การตีความ Ascendant
- การอธิบายบุคลิกภาพตามราศี Ascendant
- ข้อมูลธาตุและคุณภาพของราศี
- การเชื่อมโยงกับราศีอาทิตย์

## วิธีการใช้งาน

### รูปแบบการป้อนข้อมูล

ผู้ใช้สามารถป้อนข้อมูลในรูปแบบต่างๆ:

**แบบระบุสถานที่เกิด:**
```
เกิดวันที่ 15/03/1990 เวลา 14:30 ที่กรุงเทพฯ
เกิดวันที่ 20/07/1985 เวลา 8:15 ที่เชียงใหม่
เกิดวันที่ 10/12/1995 เวลา 22:45 ที่ภูเก็ต
```

**แบบไม่ระบุสถานที่เกิด (ใช้กรุงเทพฯ เป็นค่าเริ่มต้น):**
```
เกิดวันที่ 15/03/1990 เวลา 14:30
เกิดวันที่ 20/07/1985 เวลา 8:15
เกิดวันที่ 10/12/1995 เวลา 22:45
```

### รูปแบบเวลาที่รองรับ

- `14:30` (รูปแบบ 24 ชั่วโมง)
- `2 นาฬิกา 30 นาที`
- `เวลา 8 นาฬิกา 15 นาที`
- `8.30` (ใช้จุดแทนทวิภาค)

### สถานที่ที่รองรับ

ระบบรองรับเมืองใหญ่ในประเทศไทยกว่า 70 เมือง รวมถึง:
- กรุงเทพฯ, เชียงใหม่, เชียงราย
- ขอนแก่น, อุดรธานี, อุบลราชธานี
- ภูเก็ต, พัทยา, หัวหิน
- และเมืองอื่นๆ ทั่วประเทศ

## ตัวอย่างการใช้งาน

### ตัวอย่างที่ 1: การคำนวณ Ascendant (ระบุสถานที่เกิด)

**ข้อมูลป้อนเข้า:**
```
เกิดวันที่ 15/03/1990 เวลา 14:30 ที่กรุงเทพฯ
```

**ผลลัพธ์:**
- ราศีอาทิตย์: มีน (Pisces)
- ลัคณา: ราศีกุมภ์ 21.8° (Aquarius)
- การตีความ: คุณเป็นคนที่มีบุคลิกภาพที่เป็นอิสระ คิดต่าง และมีมนุษยธรรม

**หมายเหตุ:** ระบบโหราศาสตร์ตะวันตกจะใช้ชื่อราศีแบบไทยเท่านั้น เช่น "ราศีมีน" แทน "ราศีปลา"

### ตัวอย่างที่ 3: บ้านทั้ง 12 บ้าน

**บ้านสำคัญ:**
- ลัคณา (บ้านที่ 1): ราศีกุมภ์ 21.8°
- IC (บ้านที่ 4): ราศีพฤษภ 21.8°
- Descendant (บ้านที่ 7): ราศีสิงห์ 21.8°
- MC (บ้านที่ 10): ราศีพิจิก 21.8°

## การรวมกับระบบ RAG

### การทำนายที่แม่นยำขึ้น

เมื่อมีข้อมูล Ascendant ระบบจะ:
1. ใช้ข้อมูลราศีอาทิตย์เป็นหลัก
2. เพิ่มข้อมูล Ascendant เพื่อความแม่นยำ
3. รวมข้อมูลบ้านทั้ง 12 บ้าน
4. สร้างการทำนายที่ครอบคลุมและละเอียด

### ตัวอย่างการตอบกลับ

```
คุณเกิดวันที่ 15 มีนาคม ปี 1990 ซึ่งราศีอาทิตย์ของคุณคือราศีมีน 
และลัคณาคือราศีกุมภ์ ทำให้คุณมีลักษณะเป็นคนอ่อนโยน 
อดทน และมีความเสมอภาค คุณมีอารมณ์ที่เปลี่ยนแปลงได้ง่าย 
และมีความอ่อนโยนในการเข้าใจและรับฟังความรู้สึกของผู้อื่น
```

## การจัดการกรณีพิเศษ

### กรณีไม่มีเวลาเกิด
- ระบบจะคำนวณเฉพาะราศีอาทิตย์
- ไม่สามารถคำนวณ Ascendant ได้
- แจ้งเตือนผู้ใช้ให้ระบุเวลาเกิด

### กรณีเวลาผิดพลาด
- ตรวจสอบความถูกต้องของเวลา
- แจ้งเตือนหากเวลาไม่ถูกต้อง
- ใช้ค่าเริ่มต้นกรุงเทพฯ หากไม่พบสถานที่

### กรณีไม่ระบุสถานที่เกิด
- ใช้พิกัดกรุงเทพฯ เป็นค่าเริ่มต้นโดยอัตโนมัติ
- ยังคงคำนวณ Ascendant ได้
- ไม่แสดงการแจ้งเตือนให้ผู้ใช้ทราบ

### กรณีสถานที่ไม่มีในระบบ
- ใช้พิกัดกรุงเทพฯ เป็นค่าเริ่มต้น
- แจ้งเตือนผู้ใช้
- ยังคงคำนวณ Ascendant ได้

## ไฟล์ที่เกี่ยวข้อง

### ไฟล์หลัก
- `app/astronomical_calculator.py` - เครื่องคำนวณดาราศาสตร์
- `app/birth_date_parser.py` - ตัวแยกข้อมูลวันเกิด
- `app/retrieval_utils.py` - ระบบ RAG

### ไฟล์ทดสอบ
- `test_ascendant_system.py` - ทดสอบระบบ Ascendant

## การติดตั้งและใช้งาน

### ข้อกำหนด
- Python 3.7+
- ไลบรารีที่จำเป็น (ดู requirements.txt)

### การรันทดสอบ
```bash
python3 test_ascendant_system.py
```

### การใช้งานในโค้ด
```python
from app.birth_date_parser import BirthDateParser

parser = BirthDateParser()
birth_info = parser.extract_birth_info("เกิดวันที่ 15/03/1990 เวลา 14:30 ที่กรุงเทพฯ")
chart_info = parser.generate_birth_chart_info(
    birth_info['date'], 
    birth_info['time'], 
    birth_info['latitude'], 
    birth_info['longitude']
)

if 'ascendant' in chart_info:
    ascendant = chart_info['ascendant']
    print(f"Ascendant: ราศี{ascendant['sign']} {ascendant['degree']:.1f}°")
```

## ข้อดีของระบบใหม่

1. **ความแม่นยำสูงขึ้น** - ใช้ข้อมูลเวลาเกิดและสถานที่เกิด
2. **การทำนายที่ละเอียด** - รวมข้อมูลลัคณาและบ้านทั้ง 12 บ้าน
3. **รองรับหลายรูปแบบ** - ป้อนข้อมูลได้หลากหลายรูปแบบ
4. **ไม่จำเป็นต้องระบุสถานที่** - ใช้กรุงเทพฯ เป็นค่าเริ่มต้นอัตโนมัติโดยไม่แจ้งเตือน
5. **ใช้ชื่อราศีแบบไทย** - ระบบโหราศาสตร์ตะวันตกจะใช้ชื่อราศีแบบไทยเท่านั้น เช่น "ราศีมีน" แทน "ราศีปลา"
6. **ใช้คำว่า "ลัคณา"** - ระบบจะใช้คำว่า "ลัคณา" แทน "Ascendant" ในทุกกรณี
7. **จัดการข้อผิดพลาด** - จัดการกรณีพิเศษได้ดี
8. **บันทึกข้อมูล** - เก็บข้อมูลลัคณาในฐานข้อมูล

## การพัฒนาต่อ

### ฟีเจอร์ที่อาจเพิ่มในอนาคต
- การคำนวณตำแหน่งดาวเคราะห์อื่นๆ
- การคำนวณแอสเปค (Aspects)
- การทำนายดวงชะตารายเดือน/รายปี
- การเปรียบเทียบดวงชะตา (Synastry)

### การปรับปรุง
- เพิ่มความแม่นยำในการคำนวณ
- รองรับสถานที่เพิ่มเติม
- ปรับปรุงการตีความ
- เพิ่มข้อมูลโหราศาสตร์

## สรุป

ระบบคำนวณ Ascendant (ราศีประจำลัคนา) เป็นการพัฒนาที่สำคัญที่ทำให้แชทบอทโหราศาสตร์มีความสามารถในการทำนายที่แม่นยำและละเอียดมากขึ้น โดยใช้ข้อมูลเวลาเกิดและสถานที่เกิดในการคำนวณตำแหน่งดาราศาสตร์ที่สำคัญ ซึ่งจะช่วยให้ผู้ใช้ได้รับคำแนะนำที่เฉพาะตัวและมีประโยชน์มากขึ้น
